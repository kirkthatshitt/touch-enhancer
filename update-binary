#!/sbin/sh
# Touch Enhancer Installer
# Compatible with Magisk v20.4+

#################
# Initialization
#################

umask 022

# Print messages to UI
ui_print() { echo "$1"; }

require_new_magisk() {
  ui_print "***************************************"
  ui_print " Please install Magisk v20.4 or higher "
  ui_print "***************************************"
  exit 1
}

#########################
# Load Magisk functions
#########################

OUTFD=$2
ZIPFILE=$3

mount /data 2>/dev/null

# Make sure Magisk is installed properly
[ -f /data/adb/magisk/util_functions.sh ] || require_new_magisk
. /data/adb/magisk/util_functions.sh

# Check version
[ "$MAGISK_VER_CODE" -lt 20400 ] && require_new_magisk

#########################
# Start installation
#########################

install_module

#########################
# Finish
#########################

ui_print "=================================="
ui_print "âœ… Touch Enhancer v2.0.1 Installed!"
ui_print "   Reboot to apply the module."
ui_print "=================================="

exit 0